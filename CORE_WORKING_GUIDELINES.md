# üéØ Core Working Guidelines - Educational Fantasy RPG

## ‡∏´‡∏±‡∏ß‡πÉ‡∏à‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô (Project Development Principles)

Document ‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô **‡∏´‡∏•‡∏±‡∏Å‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô** ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ô‡πÉ‡∏à‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ

---

## üìã ‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å (Core Principles)

### ‚úÖ ‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà 1: ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÇ‡∏Ñ‡πâ‡∏î - ‡∏´‡πâ‡∏≤‡∏°‡∏•‡∏î‡∏ó‡∏≠‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡πà‡∏≠‡πÇ‡∏Ñ‡πâ‡∏î

**‡∏Å‡∏é‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô:**
- üö´ **‡∏´‡πâ‡∏≤‡∏°** ‡∏•‡∏î‡∏ó‡∏≠‡∏ô ‡∏¢‡πà‡∏≠ ‡∏´‡∏£‡∏∑‡∏≠ refactor ‡πÇ‡∏Ñ‡πâ‡∏î‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô
- ‚úÖ **‡∏ï‡πâ‡∏≠‡∏á** ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô ‡πÅ‡∏•‡∏∞‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô **100% ‡∏â‡∏ö‡∏±‡∏ö‡πÄ‡∏ï‡πá‡∏°**
- ‚úÖ **‡∏ï‡πâ‡∏≠‡∏á** ‡πÄ‡∏Å‡πá‡∏ö‡∏ö‡∏£‡∏¥‡∏ö‡∏ó (context) ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î
- ‚úÖ **‡∏ï‡πâ‡∏≠‡∏á** ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏î‡∏¥‡∏° ‡∏à‡∏∂‡∏á‡∏Ñ‡πà‡∏≠‡∏¢‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å:**
```gdscript
# WRONG - ‡∏¢‡πà‡∏≠‡πÇ‡∏Ñ‡πâ‡∏î
func _ready():
	_apply_theme()

# CORRECT - ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÄ‡∏ï‡πá‡∏°
func _ready():
	# Track current scene
	Global.current_scene = "res://Scenes/MainMenu.tscn"
	
	# Apply premium UI theme styling
	_apply_theme()
	
	# Load current story chunk
	load_chunk()
	
	# Connect Dialogue Signals
	if dialogue_system:
		if not dialogue_system.dialogue_finished.is_connected(_on_dialogue_finished):
			dialogue_system.dialogue_finished.connect(_on_dialogue_finished)
```

---

### ‚úÖ ‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà 2: ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÑ‡∏ü‡∏•‡πå - Flower Mind Mapping Structure

**‡∏Å‡∏é‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô:**
- üö´ **‡∏´‡πâ‡∏≤‡∏°** ‡πÉ‡∏´‡πâ‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ (300+ ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
- ‚úÖ **‡∏ï‡πâ‡∏≠‡∏á** ‡πÅ‡∏¢‡∏Å‡∏•‡∏≠‡∏à‡∏¥‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏¢‡πà‡∏≠‡∏¢ (Modular Architecture)
- ‚úÖ **‡∏ï‡πâ‡∏≠‡∏á** ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ú‡πà‡∏≤‡∏ô `preload()` ‡∏´‡∏£‡∏∑‡∏≠ class reference
- ‚úÖ **‡∏ï‡πâ‡∏≠‡∏á** ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏¢‡πà‡∏≠‡∏¢‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç

**Flower Mind Map Pattern:**
```
Scripts/
‚îú‚îÄ‚îÄ Core/
‚îÇ   ‚îú‚îÄ‚îÄ Global.gd              (Main game state)
‚îÇ   ‚îú‚îÄ‚îÄ ConfigManager.gd       (Configuration)
‚îÇ   ‚îî‚îÄ‚îÄ LLMService.gd          (AI Integration)
‚îÇ
‚îú‚îÄ‚îÄ UI/
‚îÇ   ‚îú‚îÄ‚îÄ UIThemeManager.gd      (Theme & Style)
‚îÇ   ‚îú‚îÄ‚îÄ MainMenu.gd            (Menu logic)
‚îÇ   ‚îî‚îÄ‚îÄ DialogueSystem.gd      (Dialogue)
‚îÇ
‚îú‚îÄ‚îÄ Battle/
‚îÇ   ‚îú‚îÄ‚îÄ Battle.gd              (Battle controller)
‚îÇ   ‚îú‚îÄ‚îÄ BattleEffectManager.gd (Visual effects)
‚îÇ   ‚îî‚îÄ‚îÄ BattleCalculations.gd  (Damage/XP logic)
‚îÇ
‚îú‚îÄ‚îÄ Systems/
‚îÇ   ‚îú‚îÄ‚îÄ QuestionSystem.gd      (Question logic)
‚îÇ   ‚îú‚îÄ‚îÄ SaveSystem.gd          (Save/Load)
‚îÇ   ‚îî‚îÄ‚îÄ QuestSystem.gd         (Quest management)
‚îÇ
‚îú‚îÄ‚îÄ Quests/
‚îÇ   ‚îî‚îÄ‚îÄ QuestManager.gd        (Quest data)
‚îÇ
‚îî‚îÄ‚îÄ StoryData.gd              (Story chunks)
```

**‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏Å‡∏¥‡∏ô 300 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î:**
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏´‡∏≤ "Concern" ‡∏ó‡∏µ‡πà‡πÅ‡∏¢‡∏Å‡πÑ‡∏î‡πâ
2. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏¢‡πà‡∏≠‡∏¢‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠ (Helper file)
3. ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á‡∏ú‡πà‡∏≤‡∏ô `preload()` ‡πÅ‡∏•‡∏∞ `const`
4. ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (Comment) ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏¢‡∏Å:**
```gdscript
# Battle.gd (400 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î) ‚Üí ‡πÅ‡∏¢‡∏Å‡πÄ‡∏õ‡πá‡∏ô 3 ‡πÑ‡∏ü‡∏•‡πå

# Battle.gd (Controller - 150 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
extends Node2D
const BattleEffectManager = preload("res://Scripts/Battle/BattleEffectManager.gd")
const BattleCalculations = preload("res://Scripts/Battle/BattleCalculations.gd")

func _ready():
	battle_effects = BattleEffectManager.new()
	battle_calc = BattleCalculations.new()

# BattleEffectManager.gd (Visual Effects - 125 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
static func shake_camera(camera: Camera2D, intensity: float, duration: float):
	# Camera shake logic

# BattleCalculations.gd (Damage/XP - 125 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)
static func calculate_damage(attacker_atk: int, defender_def: int) -> int:
	# Damage calculation logic
```

---

## üéØ ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô (Workflow Steps)

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå (Analysis)
- [ ] ‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏à‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô
- [ ] ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á
- [ ] ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ï‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡∏≠‡∏∑‡πà‡∏ô
- [ ] ‡∏´‡∏≤‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö (Design)
- [ ] ‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏ï‡∏£‡∏£‡∏Å‡∏∞‡∏ó‡∏µ‡πà‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô
- [ ] ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏¢‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
- [ ] ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô pseudocode/comment ‡πÅ‡∏™‡∏î‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏•‡∏±‡∏Å
- [ ] ‡∏ß‡∏≤‡∏î mind map ‡∏Ç‡∏≠‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÅ‡∏Å‡πâ

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 3: ‡∏û‡∏±‡∏í‡∏ô‡∏≤ (Development)
- [ ] ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡πÅ‡∏ö‡∏ö full-form (‡πÑ‡∏°‡πà‡∏¢‡πà‡∏≠)
- [ ] ‡∏£‡∏ß‡∏°‡∏ö‡∏£‡∏¥‡∏ö‡∏ó 3-5 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏Å‡πà‡∏≠‡∏ô-‡∏´‡∏•‡∏±‡∏á
- [ ] ‡πÄ‡∏û‡∏¥‡πà‡∏° comment ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏™‡πà‡∏ß‡∏ô
- [ ] ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏ß‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå (syntax)

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 4: ‡∏ó‡∏î‡∏™‡∏≠‡∏ö (Testing)
- [ ] ‡∏£‡∏±‡∏ô‡∏Ñ‡∏≠‡∏°‡πÑ‡∏û‡∏•‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î
- [ ] ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ï‡∏£‡∏£‡∏Å‡∏∞‡∏´‡∏•‡∏±‡∏Å
- [ ] ‡∏ó‡∏î‡∏•‡∏≠‡∏á‡πÉ‡∏ô‡πÄ‡∏Å‡∏° (‡∏ñ‡πâ‡∏≤‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô)
- [ ] ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ú‡∏•‡πÉ‡∏ô‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£

---

## üìù Convention & Standards

### ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î
```gdscript
# 1. Imports & Constants ‡∏ó‡∏µ‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡∏™‡∏∏‡∏î
extends Node
const BattleEffectManager = preload("res://Scripts/Battle/BattleEffectManager.gd")

# 2. Properties
var player_hp = 100
var player_max_hp = 100

# 3. Lifecycle (_ready, _process, etc.)
func _ready():
	_initialize_systems()
	_apply_theme()
	_load_data()

# 4. Public methods (‡πÑ‡∏°‡πà‡∏°‡∏µ underscore)
func start_battle():
	pass

# 5. Private methods (_underscore)
func _initialize_systems():
	pass

# 6. Signal handlers (_on_event_name)
func _on_button_pressed():
	pass
```

### Naming Convention
- **Files:** `PascalCase.gd` (MainMenu.gd, BattleEffectManager.gd)
- **Functions:** `snake_case()` (get_unique_question(), apply_button_theme())
- **Constants:** `CONSTANT_CASE` (COLOR_PRIMARY, FONT_SIZE_LARGE)
- **Private:** `_snake_case()` (_apply_theme(), _initialize())

### Comment Pattern
```gdscript
# === SECTION NAME ===

func important_function():
	"""Explain purpose of this function"""
	# Explain non-obvious logic here
	var result = calculate()
	
	# Why we do this specific operation
	return process(result)
```

---

## üöÄ ‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö Features

**‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö:**
1. ‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö compilation errors: 0
2. ‚úÖ ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏ï‡πá‡∏°‡∏â‡∏ö‡∏±‡∏ö (‡πÑ‡∏°‡πà‡∏¢‡πà‡∏≠)
3. ‚úÖ Add comments ‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠
4. ‚úÖ Test ‡∏ö‡∏ô‡πÄ‡∏Å‡∏° (‡∏ñ‡πâ‡∏≤‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô)
5. ‚úÖ Update ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á

---

## üìö Related Documents

- [Flower Mind Map - Architecture](./PROJECT_STRUCTURE.md)
- [API Documentation](./API_DOCUMENTATION.md)
- [Quality Checklist](./QUALITY_CHECKLIST.md)
- [Setup Guide](./SETUP_GUIDE.md)

---

## ‚úçÔ∏è ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥

| ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà | ‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç | ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ |
|--------|-----------|--------|
| 2026-02-15 | v1.0 | ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å |

---

**‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÅ‡∏•‡∏∞‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏Ñ‡∏£‡πà‡∏á‡∏Ñ‡∏£‡∏±‡∏î ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ œÜ(‡πë‚Ä¢ÃÅ ‚ñΩ ‚Ä¢ÃÄ‡πë)**
